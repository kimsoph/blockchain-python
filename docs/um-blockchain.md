# 블록체인 기본 원리

> 초보자를 위한 블록체인 핵심 개념 정리

---

## 1. 블록체인이란?

**한 줄 정의**: 여러 컴퓨터가 공유하는 "수정 불가능한 장부"

### 비유로 이해하기

```
일반 장부 (중앙화)          블록체인 (분산화)
    [은행]                  [A] [B] [C] [D]
      ↓                      ↓   ↓   ↓   ↓
  모든 기록              모두 같은 장부 보유
  은행이 관리            누구도 혼자 수정 불가
```

**핵심**: 모든 참여자가 같은 기록을 갖고 있어서, 누군가 몰래 바꾸면 즉시 들통남

---

## 2. 블록(Block)이란?

**한 줄 정의**: 거래 기록을 담은 "상자"

### 블록의 구성

```
┌─────────────────────────┐
│ Block #3                │
├─────────────────────────┤
│ 이전 블록 해시: abc123  │  ← 이전 블록과 연결
│ 타임스탬프: 2024-01-01  │
│ 거래 내용:              │
│   - Alice → Bob: 10원   │
│   - Bob → Charlie: 5원  │
│ Nonce: 12345            │
│ 해시: def456            │  ← 이 블록의 지문
└─────────────────────────┘
```

**예시**: 택배 상자에 송장 번호(해시)가 붙어있고, 이전 상자 번호도 적혀있는 것

---

## 3. 체인(Chain)이란?

**한 줄 정의**: 블록들이 순서대로 연결된 "사슬"

```
[Block 0] → [Block 1] → [Block 2] → [Block 3]
 Genesis     hash:abc     hash:def     hash:ghi
             prev:000     prev:abc     prev:def
```

**왜 체인인가?**
- 각 블록은 이전 블록의 해시를 저장
- 중간 블록 수정 → 뒤의 모든 해시가 깨짐 → 조작 즉시 발각

**예시**: 도미노처럼 하나 건드리면 뒤가 다 무너짐

---

## 4. 해시(Hash)란?

**한 줄 정의**: 데이터의 "지문" (고유 식별자)

### 해시의 특징

| 특징 | 설명 |
|------|------|
| 고정 길이 | 입력 크기와 무관하게 항상 64자 |
| 단방향 | 해시 → 원본 복원 불가능 |
| 민감성 | 한 글자만 바꿔도 완전히 다른 해시 |

### 예시

```python
"안녕하세요" → a1b2c3d4e5f6...  (64자)
"안녕하세욧" → z9y8x7w6v5u4...  (완전히 다름!)
```

**비유**: 사람의 지문 - 똑같은 지문을 가진 사람은 없음

---

## 5. 채굴(Mining)이란?

**한 줄 정의**: 조건에 맞는 해시를 찾는 "노가다"

### 작업 증명 (Proof of Work)

```
목표: 해시가 "0000"으로 시작하는 숫자(Nonce) 찾기

시도 1: Nonce=1 → 해시: a3f2... ❌
시도 2: Nonce=2 → 해시: 8b1c... ❌
...
시도 50000: Nonce=50000 → 해시: 0000abc... ✓ 성공!
```

**왜 이런 짓을?**
- 블록 생성에 "비용"(시간, 전기)이 들게 함
- 조작하려면 엄청난 컴퓨팅 파워 필요
- 정직하게 채굴하는 게 이득

**보상**: 채굴 성공 시 코인 지급 (비트코인: 현재 6.25 BTC)

### Nonce 심층 이해: PoW 채굴의 본질

**Nonce = Number used ONCE** (한 번만 사용되는 숫자)

#### 왜 Nonce가 핵심인가?

블록의 해시는 다음 데이터로 계산됩니다:

```
해시 = SHA256(이전해시 + 타임스탬프 + 거래내용 + Nonce)
```

여기서 **Nonce만 자유롭게 바꿀 수 있는 값**입니다:
- 이전 해시: 고정 (이전 블록에서 결정됨)
- 타임스탬프: 고정 (현재 시간)
- 거래 내용: 고정 (포함할 트랜잭션들)
- **Nonce: 변경 가능** ← 이것만 조절!

#### 채굴 = Nonce 찾기

```
┌─────────────────────────────────────────────────────┐
│                    채굴 과정                         │
├─────────────────────────────────────────────────────┤
│                                                     │
│  목표: 해시가 "0000"으로 시작해야 함 (난이도=4)      │
│                                                     │
│  [고정값]                    [변경값]               │
│  ┌─────────────────────┐    ┌─────────┐            │
│  │ 이전해시: abc123    │    │ Nonce=? │            │
│  │ 시간: 2024-01-01    │ +  │         │ → 해시계산 │
│  │ 거래: Alice→Bob     │    └─────────┘            │
│  └─────────────────────┘                           │
│                                                     │
│  Nonce=1    → 해시: 7f3a2b... ❌ (0으로 안시작)     │
│  Nonce=2    → 해시: e5c8d1... ❌                    │
│  Nonce=3    → 해시: 2a9f4e... ❌                    │
│  ...                                               │
│  Nonce=78803 → 해시: 0000c2... ✓ 성공!             │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### 왜 "한 번만 사용"인가?

```
Block #5 채굴 시: Nonce=78803으로 성공
Block #6 채굴 시: 같은 78803이 통할까? → ❌ 절대 안됨!

이유:
- Block #6의 "이전 해시"가 다름 (Block #5의 해시)
- Block #6의 "거래 내용"이 다름
- Block #6의 "타임스탬프"가 다름

→ 매번 새로운 Nonce를 처음부터 찾아야 함
→ 그래서 "Number used ONCE"
```

#### 난이도와 Nonce의 관계

| 난이도 | 조건 | 평균 시도 횟수 | 시간 |
|--------|------|---------------|------|
| 1 | 0으로 시작 | ~16회 | 즉시 |
| 2 | 00으로 시작 | ~256회 | 즉시 |
| 4 | 0000으로 시작 | ~65,536회 | 수초 |
| 6 | 000000으로 시작 | ~1,677만회 | 수분 |
| 비트코인 | 0 약 19개 | ~수조회 | ~10분 |

**핵심 공식**: 난이도 N → 평균 16^N 번 시도 필요

#### 비유: 자물쇠 비밀번호 찾기

```
상황: 4자리 자물쇠 (0000~9999)
조건: 비밀번호가 "0000"으로 시작해야 열림

방법: 0000, 0001, 0002... 하나씩 시도
      → 언젠가 맞는 번호 발견
      → 이게 채굴!

Nonce = 시도하는 번호
해시 = 자물쇠의 반응 (열림/안열림)
난이도 = 자물쇠의 복잡도
```

#### 결론: Nonce 찾기 = PoW의 본질

```
┌────────────────────────────────────────┐
│  "채굴한다" = "Nonce를 찾는다"          │
│                                        │
│  • 수학 문제를 푸는 게 아님            │
│  • 그냥 숫자를 1씩 올려가며 대입       │
│  • 조건 맞는 해시 나올 때까지 반복     │
│  • 운 + 컴퓨팅 파워 = 채굴 성공        │
└────────────────────────────────────────┘
```

---

## 6. 분산 네트워크

**한 줄 정의**: 여러 컴퓨터가 같은 장부를 유지

```
        ┌─────┐
        │노드A│ ←─┐
        └─────┘   │
   ┌─────┐    ┌─────┐
   │노드B│ ←→ │노드C│
   └─────┘    └─────┘
        │         │
        └──→ ┌─────┐
             │노드D│
             └─────┘

모든 노드가 동일한 블록체인 보유
새 블록 → 모든 노드에 전파
```

**51% 공격**: 전체 노드의 과반수를 장악해야 조작 가능 (현실적으로 불가능)

---

## 7. 트랜잭션 흐름

```
1. Alice가 Bob에게 10코인 전송 요청
        ↓
2. 트랜잭션이 네트워크에 전파
        ↓
3. 채굴자가 트랜잭션을 블록에 담음
        ↓
4. 채굴 성공 (해시 조건 만족)
        ↓
5. 새 블록이 체인에 추가
        ↓
6. 모든 노드가 동기화
        ↓
7. Bob의 잔액 +10 확정
```

---

## 8. 핵심 요약

| 개념 | 한 줄 설명 |
|------|-----------|
| 블록체인 | 분산된 수정 불가 장부 |
| 블록 | 거래 기록 묶음 |
| 해시 | 데이터 지문 |
| 채굴 | 조건 맞는 해시 찾기 |
| 분산 | 모든 노드가 같은 기록 보유 |

---

## 9. 이 프로젝트에서 실습

```bash
# 실행
python -m src.main

# 데모 모드로 체험
y 입력
```

**실습 항목**:
1. 블록 생성 및 채굴 과정 확인
2. 트랜잭션 생성 → 블록에 포함
3. 잔액 변화 확인
4. 데이터 변조 시 해시 불일치 확인

---

## 10. 더 알아보기

- **비트코인 백서**: [bitcoin.org/bitcoin.pdf](https://bitcoin.org/bitcoin.pdf)
- **이더리움**: 스마트 컨트랙트 (프로그래밍 가능한 블록체인)
- **합의 알고리즘**: PoW, PoS, DPoS 등
